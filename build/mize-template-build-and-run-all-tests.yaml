parameters:
  DataFileDirectory: 'Debug'

jobs: #Build and stage projects

- job: 'BuildAndStageDesktopAndUnitTestProjects'
  pool:
      vmImage: 'windows-2022'
      demands:
      - msbuild
      - visualstudio

  steps:
  # Bootstrap the build
  - template: template-build-and-prep-automation.yaml
    parameters:
      MSAL_DESKTOP_ONLY_DEV: 'true'
      PUBLISH_OUTPUT: true
  
- job: 'BuildAndStageAllProjects'
  pool:
      vmImage: 'windows-2022'
      demands:
      - msbuild
      - visualstudio

  steps:
  # Bootstrap the build
  - template: template-build-and-prep-automation.yaml
    parameters:
      MSAL_DESKTOP_ONLY_DEV: ''
      PUBLISH_OUTPUT: false

  #Desktop Unit + Integration Tests
- job: 'RunDesktopTests'
  dependsOn:
  - 'BuildAndStageDesktopAndUnitTestProjects'
  pool:
      vmImage: 'windows-2022'
      demands:
      - msbuild
      - visualstudio
  variables:
      runCodesignValidationInjection: false

  steps:
  - template: template-desktop-unit-and-automation.yaml
